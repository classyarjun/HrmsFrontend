<div class="home">
  <div class="container-fluid p-4">

    <div class="row">
      <div class=" card-title text-muted  my-4">
        <h6 class="card-title fs-4 mb-0">Good Morning</h6>
      </div>
    </div>

    <!-- Header Row -->
    <div class="row g-4 mb-4">
      <!-- Review Card -->
      <div class="col-lg-4 col-md-6">
        <div class="card h-100">
          <div class="card-header pb-2">
            <h6 class="card-title text-muted mb-0">Review</h6>
          </div>
          <div class="card-body text-center py-4">
            <div class="d-flex justify-content-center mb-3">
              <div class="position-relative">
                <i class="bi bi-clipboard-check display-4 text-primary"></i>
                <span
                  class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning notification-badge">
                  âœ“
                </span>
              </div>
            </div>
            <p class="text-muted small mb-0">Hurrah! You've nothing to review.</p>
          </div>
        </div>
      </div>

      <!-- Date/Time Card -->
      <div class="col-lg-4 col-md-6">
        <div class="card h-100">
          <div class="card-body text-center py-4">

            <!-- Status and Date -->
            <div class="d-flex align-items-center justify-content-center mb-2">
              <span class="status-dot bg-success me-2"></span>
              <small class="text-muted">{{ currentDate }}</small>
            </div>

            <p class="text-muted small mb-3">General Shift</p>
            <div class="time-display text-dark mb-4">{{ timeString }}</div>

            <!-- Sign In Button -->
            <button class="btn btn-primary px-4" data-bs-toggle="modal" data-bs-target="#workLocationModal"
              *ngIf="!isSignedIn">
              Sign In
            </button>

            <!-- Buttons when signed in -->
            <div class="d-flex gap-3 justify-content-center mt-3" *ngIf="isSignedIn">
              <!-- View Swipes -->
              <button class="btn btn-outline-primary px-4" (click)="openSwipeModal()">
                View Swipes
              </button>

              <!-- Sign Out -->
              <button class="btn btn-danger px-4" (click)="signOut()">
                <i class="bi bi-box-arrow-right me-2"></i>
                Sign Out
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Work Location Modal -->
      <!-- Work Location Modal -->
      <div class="modal fade" id="workLocationModal" tabindex="-1" aria-labelledby="workLocationLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
          <div class="modal-content shadow-sm rounded-3 border-0">

            <form (ngSubmit)="signIn()" #signInForm="ngForm">

              <div class="modal-header bg-light border-0">
                <h5 class="modal-title fw-semibold text-secondary">Tell us your work location</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>

              <div class="modal-body row g-4 px-4 py-3">

                <!-- Form Inputs -->
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="location" class="form-label">Enter Sign-In Location <span
                        class="text-danger">*</span></label>
                    <select id="location" name="location" class="form-select" [(ngModel)]="attendanceData.location"
                      required>
                      <option value="" disabled selected>Select Location</option>
                      <option>Work from Home</option>
                      <option>Client Site</option>
                      <option>Office</option>
                    </select>
                  </div>

                  <div class="mb-3">
                    <label for="remarks" class="form-label">Remarks</label>
                    <textarea id="remarks" name="remarks" class="form-control" rows="3"
                      [(ngModel)]="attendanceData.remarks" placeholder="Enter Reason"></textarea>
                  </div>

                  <button type="submit" class="btn btn-primary w-100">Sign In</button>
                </div>

                <!-- Right Side Image -->
                <div class="col-md-6 d-none d-md-flex align-items-center justify-content-center">
                  <img src="/assets/work-location.jfif" alt="Location Image" class="img-fluid rounded shadow-sm" />
                </div>

              </div>

            </form>
          </div>
        </div>
      </div>

      <!-- Swipes Modal -->
      <div class="modal fade" id="swipeModal" tabindex="-1" aria-labelledby="swipeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
          <div class="modal-content shadow-sm rounded border-0">
            <div class="modal-header bg-light border-0">
              <h5 class="modal-title fw-semibold text-secondary">Swipes</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body px-4 pt-2 pb-4">
              <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap px-1">
                <div><strong>Date:</strong> {{ currentDate }}</div>
                <div><strong>Shift Time:</strong> 09:30 to 18:30</div>
                <div><strong>Shift Type:</strong> GEN</div>
              </div>

              <div class="table-responsive">
                <table class="table table-bordered table-sm mb-0" style="background-color: #f8f9fa;">
                  <thead class="table-light">
                    <tr class="text-center">
                      <th>Swipe Time</th>
                      <th>Door/Address</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="text-center">
                      <td>{{ signInTime }}</td>
                      <td>-</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!--! Upcoming Holidays Card -->

      <div class="col-lg-4 col-md-12">
        <div class="card h-100" style="overflow-y: auto; max-height: 300px;">
          <div class="card-header pb-2">
            <div class="d-flex justify-content-between align-items-center">
              <h6 class="card-title text-muted mb-0">Upcoming Holidays</h6>
              <!-- <i class="bi bi-chevron-right text-muted"></i> -->
            </div>
          </div>

 <div *ngFor="let holiday of holidays" class="holiday-item">
  <div>
    <span class="fw-semibold small">{{ holiday.date | date:'dd MMM' }}</span>
    <span class="badge bg-primary ms-2 small">{{ holiday.date | date:'EEEE' }}</span>
    <p class="text-muted small mb-0">{{ holiday.name }}</p>
  </div>
</div>

        </div>
      </div>
    </div>

    <!-- Second Row -->
    <div class="row g-4 mb-4">
      <!-- IT Declaration Card -->
      <div class="col-lg-3 col-md-6">
        <div class="card h-100">
          <div class="card-header pb-2">
            <h6 class="card-title text-muted mb-0">IT Declaration</h6>
          </div>
          <div class="card-body text-center py-4">
            <div class="d-flex justify-content-center mb-3">
              <div class="position-relative">
                <i class="bi bi-laptop display-6 text-primary"></i>
                <span
                  class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning notification-badge">
                  !
                </span>
              </div>
            </div>
            <p class="text-muted small mb-3">
              Hurry! Your IT declaration is awaiting. Please submit it before the window gets closed.
            </p>
            <button class="btn btn-outline-primary btn-sm">Declare</button>
          </div>
        </div>
      </div>

      <!-- Quick Access Card -->
      <div class="col-lg-6 col-md-12">
        <div class="card h-100">
          <div class="card-header pb-2">
            <h6 class="card-title text-muted mb-0">Quick Access</h6>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-6">
               
                <div class="mb-2">
                  <a href="reimbursement-payslip" class="text-decoration-none small">Reimbursement Payslip</a>
                </div>
                 <div class="mb-2">
                  <a href="ytd-reports" class="text-decoration-none small">YTD Reports</a>
                </div>
              </div>
              <div class="col-6">
                <div class="mb-2">
                  <a href="it-statement" class="text-decoration-none small">IT Statement</a>
                </div>
              
         
              <div class="mb-2">
                
                  <a href="loan-statment" class="text-decoration-none small">Loan Statement</a>
                </div>
            </div>
</div>
            <div class="mt-3">
              <small class="text-muted">Use quick access to view important salary details.</small>
            </div>
          </div>
        </div>
</div>
      <!-- Payslip Card -->
      <div class="col-lg-3 col-md-6">
        <div class="card h-100">
          <div class="card-header pb-2">
            <h6 class="card-title text-muted mb-0">Payslip</h6>
          </div>
          <div class="card-body text-center py-4">
            <div class="d-flex justify-content-center mb-3">
              <div class="position-relative">
                <div class="payslip-icon d-flex align-items-center justify-content-center rounded">
                  <i class="bi bi-credit-card text-success"></i>
                </div>
                <span
                  class="position-absolute bottom-0 end-0 translate-middle badge rounded-pill bg-warning notification-badge">
                  ?
                </span>
              </div>
            </div>
            <p class="text-muted small mb-0">
              Uh oh! Your Payslip will show up here after the release of Payroll.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Third Row -->
    <div class="row g-4">
      <!-- Track Card -->
      <div class="col-lg-6 col-md-12">
        <div class="card h-100  ">
          <div class="card-header bg-light border-0 rounded-top-4">
            <h5 class="card-title text-primary fw-bold mb-0">ðŸ“Š Leave Summary</h5>
          </div>
          <div class="card-body p-4 overflow-auto" style="max-height: 400px;">
            <!-- âœ… Latest Leave Status -->
            <div *ngIf="leaveInfo.latestStatus" class="alert mb-4 text-center" [ngClass]="{
        'alert-success': leaveInfo.latestStatus === 'APPROVED',
        'alert-danger': leaveInfo.latestStatus === 'REJECTED',
        'alert-warning': leaveInfo.latestStatus === 'PENDING'
      }">
              <strong>Leave Status:</strong> Your last leave
              <span class="fw-semibold">({{ leaveInfo.latestDate | date: 'dd MMM yyyy' }})</span> was
              <strong class="text-uppercase">{{ leaveInfo.latestStatus }}</strong>.
            </div>

            <!-- âœ… Leave Details Summary -->
            <ul class="list-group list-group-flush">
              <li class="list-group-item d-flex justify-content-between">
                <span>Total Approved Leaves</span>
                <span class="fw-bold text-success">{{ leaveInfo.totalApproved }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Sick Leaves Used</span>
                <span class="fw-bold">{{ leaveInfo.sickLeave }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Casual Leaves Used</span>
                <span class="fw-bold">{{ leaveInfo.casualLeave }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Sample Leaves Used</span>
                <span class="fw-bold">{{ leaveInfo.sampleLeave }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Paid Leaves Used</span>
                <span class="fw-bold">{{ leaveInfo.paidLeave }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Unpaid Leaves Used</span>
                <span class="fw-bold">{{ leaveInfo.unpaidLeave }}</span>
              </li>
              <li class="list-group-item d-flex justify-content-between">
                <span>Maternity Leaves Used</span>
                <span class="fw-bold">{{ leaveInfo.maternityLeave }}</span>
              </li>
            </ul>
          </div>
        </div>
      </div>


      <!-- Task Card -->
      <div class="col-lg-6 col-md-12">
        <div class="card h-100 shadow-sm border-0 ">
          <!-- Header -->
          <div
            class="card-header bg-white border-bottom rounded-top-4 d-flex align-items-center justify-content-between">
            <h5 class="card-title text-primary fw-bold mb-0">
              <i class="bi bi-check2-square me-2"></i>Task Summary
            </h5>
          </div>

          <!-- Body -->
          <div class="card-body px-4 py-3 overflow-auto" style="max-height: 400px;">
            <div *ngIf="userTasks.length > 0; else noTasks">
              <ul class="list-group list-group-flush">
                <li class="list-group-item bg-light mb-3 rounded shadow-sm border-0" *ngFor="let task of userTasks">
                  <div class="d-flex flex-column">
                    <div class="fw-semibold text-dark">
                      <i class="bi bi-clipboard-check me-2 text-success"></i>{{ task.taskName }}
                    </div>

                    <div class="mt-2">
                      <span class="badge rounded-pill bg-secondary me-2">
                        <i class="bi bi-calendar-check me-1"></i> Assigned: {{ task.taskAssignDate | date:'dd MMM' }}
                      </span>
                      <span class="badge rounded-pill bg-warning text-dark me-2">
                        <i class="bi bi-hourglass-split me-1"></i> Due: {{ task.dueDate | date:'dd MMM' }}
                      </span>
                      <span class="badge rounded-pill" [ngClass]="{
                    'bg-primary': task.status === 'PENDING',
                    'bg-info text-dark': task.status === 'IN_PROGRESS',
                    'bg-success': task.status === 'COMPLETED'
                  }">
                        <i class="bi bi-check2-circle me-1"></i> {{ task.status }}
                      </span>
                    </div>
                  </div>
                </li>
              </ul>
            </div>

            <!-- No Tasks Template -->
            <ng-template #noTasks>
              <div class="text-center text-muted py-3">
                <i class="bi bi-emoji-neutral fs-4 d-block mb-2"></i>
                <p class="mb-0">No tasks assigned yet.</p>
              </div>
            </ng-template>
          </div>


        </div>
      </div>


<!-- ! yahase start kiya tha  -->
          <div class="card-body px-4 py-3 overflow-auto" style="max-height: 400px;">
            <div *ngIf="pendingRequests.length > 0; else noRequests">
              <ul class="list-group list-group-flush">
                <li class="list-group-item bg-light mb-3 rounded shadow-sm border-0"
                  *ngFor="let req of pendingRequests">
                  <div class="d-flex flex-column">

                    <!-- Request Type -->
                    <div class="fw-semibold text-dark mb-2">
                      <i class="bi bi-file-earmark-text me-2 text-primary"></i>
                      {{ req.requestType === 'REGULARIZATION' ? 'Regularization' : 'Permission' }}
                    </div>

                    <!-- Date & Time Info -->
                    <div class="mt-1">
                      <span class="badge rounded-pill bg-secondary me-2">
                        <i class="bi bi-calendar-event me-1"></i> Date: {{ req.date | date:'dd MMM yyyy' }}
                      </span>
                      <span class="badge rounded-pill bg-success me-2">
                        <i class="bi bi-clock me-1"></i> In: {{ req.clockIn }}
                      </span>
                      <span class="badge rounded-pill bg-danger me-2">
                        <i class="bi bi-clock-history me-1"></i> Out: {{ req.clockOut }}
                      </span>
                    </div>

                    <!-- Reason -->
                    <div class="mt-2">
                      <span class="badge rounded-pill bg-dark">
                        <i class="bi bi-chat-left-text me-1"></i> {{ req.reason }}
                      </span>
                    </div>

                    <!-- Status -->
                    <div class="mt-3">
                      <span class="badge rounded-pill" [ngClass]="{
                    'bg-warning text-dark': req.approvalStatus === 'PENDING',
                    'bg-success': req.approvalStatus === 'APPROVED',
                    'bg-danger': req.approvalStatus === 'REJECTED'
                  }">
                        <i class="bi bi-check2-circle me-1"></i> {{ req.approvalStatus }}
                      </span>
                    </div>

                  </div>
                </li>
              </ul>
            </div>

            <!-- No Data Template -->
            <ng-template #noRequests>
              <p class="text-center text-muted my-3">No regularization or permission requests found.</p>
            </ng-template>
          </div>
    </div>

    <!-- Footer -->
    <div class="text-center mt-5">
      <small class="text-muted">
        <!-- <span>v6.3.0-prod-1043</span> -->
        <!-- <span class="mx-2">|</span> -->
        <a href="/privacy-policy" target="_blank" rel="noopener noreferrer" class="text-muted text-decoration-none">
          Privacy Policy
        </a>
        <span class="mx-2">|</span>
        <a href="/terms-and-conditions" target="_blank" rel="noopener noreferrer"
          class="text-muted text-decoration-none">
          Terms Of Service
        </a>

      </small>
    </div>
  </div>
</div>



<!-- Modal -->
<div class="modal fade" id="workLocationModal" tabindex="-1" aria-labelledby="workLocationLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">

      <form (ngSubmit)="signIn()" #signInForm="ngForm">

        <div class="modal-header">
          <h5 class="modal-title">Tell us your work location</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body row">

          <!-- Form Inputs -->
          <div class="col-md-6">
            <div class="mb-3">
              <label for="location" class="form-label">Enter Sign-In Location<span class="text-danger">*</span></label>
              <select id="location" name="location" class="form-select" [(ngModel)]="attendanceData.location" required>
                <option value="" disabled selected>Select Location</option>
                <option>Work from Home</option>
                <option>Client Site</option>
                <option>Office</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="remarks" class="form-label">Remarks</label>
              <textarea id="remarks" name="remarks" class="form-control" [(ngModel)]="attendanceData.remarks"
                placeholder="Enter Reason"></textarea>
            </div>

            <button type="submit" class="btn btn-primary">Sign in</button>
          </div>

          <!-- Image -->
          <div class="col-md-6 d-none d-md-block text-center">
            <img src="/assets/work-location.jfif" alt="Location Image" class="img-fluid rounded" />
          </div>
        </div>

      </form>
    </div>
  </div>
</div>
